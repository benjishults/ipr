;; should be valid
(forall ((a) (b) (c))
  (iff (forall ((x)) (implies (and (p a) (implies (p x) (p b)))
                       (p c)))
       (and (forall ((x)) (or (not (p a)) (p x) (p c)))
            (or (not (p a)) (not (p b)) (p c)))))

;; should be valid
(iff (iff (for-some ((x)) (forall ((y)) (iff (p x) (p y))))
          (iff (for-some ((x)) (q x)) (forall ((y)) (q y))))
     (iff (for-some ((x)) (forall ((y)) (iff (q x) (q y))))
          (iff (for-some ((x)) (p x))
               (forall ((y)) (p y)))))

;; should be valid
(forall ((a))
  (iff (forall ((x))
         (implies (and (p a) (implies (p x)
                               (for-some ((y)) (and (p y) (r2 x y)))))
           (for-some ((z) (w)) (and (p z) (r2 x w) (r2 w z)))))
       (forall ((x))
         (and (or (not (p a)) (p x) (for-some ((z) (w))
                                      (and (p z) (r2 x w) (r2 w z))))
              (or (not (p a)) (not (for-some ((y)) (and (p y) (r2 x y))))
                  (for-some ((z) (w))
                    (and (p z) (r2 x w) (r2 w z))))))))

;; should be valid
(implies (and (forall ((x)) (implies (f x)
                              (and (for-some ((y))
                                     (and (g y) (h2 x y)))
                                   (for-some ((y))
                                     (and (g y) (not (h2 x y)))))))
              (for-some ((x)) (and (j x) (forall ((y))
                                           (implies (g y) (h2 x y))))))
  (for-some ((x)) (and (j x) (not (f x)))))

;; should be valid
(implies (and (forall ((x)) (and (f x) (implies (forall ((y))
                                                  (implies (and (g y) (h2 x y))
                                                    (j2 x y)))
                                         (forall ((y))
                                           (implies (and (g y) (h2 x y))
                                             (k y))))))
              (not (for-some ((y)) (and (l y) (k y))))
              (for-some ((x))
                (and (f x) (forall ((y))
                             (implies (h2 x y) (l y)))
                     (forall ((y)) (implies (and (g y) (h2 x y)) (j2 x y))))))
  (for-some ((x)) (and (f x) (not (for-some ((y)) (and (g y) (h2 x y)))))))

;; should be valid
(implies (and (forall ((x)) (implies (wolf x) (animal x)))
              (forall ((x)) (implies (fox x) (animal x)))
              (forall ((x)) (implies (bird x) (animal x)))
              (forall ((x)) (implies (catepillar x) (animal x)))
              (forall ((x)) (implies (snail x) (animal x)))
              (for-some ((wolf)) (wolf wolf))
              (for-some ((fox)) (fox fox))
              (for-some ((bird)) (bird bird))
              (for-some ((catepillar)) (catepillar catepillar))
              (for-some ((snail)) (snail snail))
              (forall ((x)) (implies (grain x) (plant x)))
              (for-some ((grain)) (grain grain))
              (forall ((x))
                (implies (animal x)
                  (or (forall ((p)) (implies (plant p) (eats x p)))
                      (forall ((a)) (implies (and (animal a) (smaller-than a x)
                                                  (for-some ((p))
                                                    (and (plant p)
                                                         (eats a p))))
                                      (eats x a))))))
              (forall ((b) (c) (s) (f) (w))
                (implies (and (bird b) (catepillar c) (snail s) (wolf w)
                              (fox f))
                  (and (smaller-than c b) (smaller-than s b)
                       (smaller-than b f) (smaller-than f w))))
              (forall ((w) (f) (g))
                (implies (and (wolf w) (fox f) (grain g))
                  (and (not (eats w f)) (not (eats w g)))))
              (forall ((b) (c) (s))
                (implies (and (bird b) (catepillar c) (snail s))
                  (and (eats b c) (not (eats b s)))))
              (forall ((c))
                (implies (catepillar c)
                  (for-some ((p)) (and (plant p) (eats c p)))))
              (forall ((s))
                (implies (snail s)
                  (for-some ((p)) (and (plant p) (eats s p))))))
  (for-some ((a)) (and (animal a) (for-some ((ag) (g))
                                    (and (grain g) (animal ag) (eats ag g)
                                         (eats a ag))))))

;; should be valid
(implies (and (forall ((x) (y)) (t (i x (i y x))))
              (forall ((x) (y) (z)) (t (i (i x (i y z)) (i (i x y) (i x z)))))
              (forall ((x) (y)) (t (i (i (n x) (n y)) (i y x))))
              (forall ((x) (y)) (implies (and (t (i x y)) (t x)) (t y))))
  (forall ((x)) (t (i x (n (n x))))))

;; should be valid
(implies (and (forall ((x) (y)) (t (i x (i y x))))
              (forall ((x) (y) (z)) (t (i (i x (i y z)) (i (i x y) (i x z)))))
              (forall ((x) (y)) (t (i (i (n x) (n y)) (i y x))))
              (forall ((x) (y)) (implies (and (t (i x y)) (t x)) (t y))))
  (forall ((x)) (t (i (n (n x)) x))))

;; should be valid
(implies (and (forall ((x) (y)) (t (i x (i y x))))
              (forall ((x) (y) (z)) (t (i (i x (i y z)) (i (i x y) (i x z)))))
              (forall ((x) (y)) (t (i (i y x) (i (n x) (n y)))))
              (forall ((x) (y)) (implies (and (t (i x y)) (t x)) (t y))))
  (forall ((x)) (t (i x (n (n x))))))

;; should be valid
(implies (and (forall ((x) (y)) (t (i x (i y x))))
              (forall ((x) (y) (z)) (t (i (i x (i y z)) (i (i x y) (i x z)))))
              (forall ((x) (y)) (t (i (i (n x) (n y)) (i y x))))
              (forall ((x) (y)) (implies (and (t (i x y)) (t x)) (t y)))
              (forall ((x) (y)) (t (i (b1 (i x y)) (i (b x) (b y)))))
              (forall ((x)) (t (i (b1 x) x)))
              (forall ((x)) (implies (t x) (t (b1 x)))))
  (forall ((x)) (t (i (b1 x) (n (b1 (n x)))))))

;; should be valid
(forall ((peanuts) (john) (bill) (sue) (apples) (chicken))
  (implies                              ;for checking out detail
      (and
       (forall ((x)) (forall ((y)) (implies (and (alive y)
                                                 (eats y chicken))
                                     (likes y x))))
       (forall ((x)) (implies (food x) (likes john x)))
       (food apples)
       (food chicken)
       (forall ((x)) (implies (for-some ((y)) (and (eats y x)
                                                   (not-killed-by y x)))
                       (food x)))
       (eats bill peanuts)
       (alive bill)
       (forall ((x)) (implies (eats bill x) (eats sue x)))
       (forall ((y)) (implies (alive y)
                       (forall ((x)) (not-killed-by y x)))))
    (likes john peanuts)))

;; From Smullyan FOL 1968
;; fails with q=2
;; out of memory with q=3
(implies (and (forall ((x)) (implies (implies (and (F x) (G x)) (H x))
                              (for-some ((y)) (and (f y) (not (g y))))))
              (or (forall ((w)) (implies (f w) (g w)))
                  (forall ((z)) (implies (f z) (h z)))))
  (implies (forall ((r)) (implies (and (f r) (h r))
                           (g r)))
    (for-some ((v)) (and (f v) (g v) (not (h v))))))

;; slow (quit)
;; I suspect this requires q>2 but haven't checked.
(forall ((e))
  (implies
      (and (forall ((x) (y)) (for-some ((z)) (p3 x y z)))
           (forall ((x) (y) (z) (u) (v) (w))
             (implies (and (p3 x y u) (p3 y z v) (p3 u z w))
               (p3 x v w)))
           (forall ((x) (y) (z) (u) (v) (w))
             (implies (and (p3 x y u) (p3 y z v) (p3 x v w))
               (p3 u z w)))
           (forall ((x)) (p3 x e x))
           (forall ((x)) (p3 e x x))
           (forall ((x)) (p3 x (i x) e))
           (forall ((x)) (p3 (i x) x e)))
    (implies (forall ((x)) (p3 x x e))
      (forall ((u) (v) (w)) (implies (p3 u v w) (p3 v u w))))))

;; slow (quit)
;; I suspect this requires q>2 but haven't checked.
(forall ((e))
  (implies
      (and (forall ((x) (y)) (for-some ((z)) (p3 x y z)))
           (forall ((x) (y) (z) (u) (v) (w))
             (implies (and (p3 x y u) (p3 y z v) (p3 u z w))
               (p3 x v w)))
           (forall ((x) (y) (z) (u) (v) (w))
             (implies (and (p3 x y u) (p3 y z v) (p3 x v w))
               (p3 u z w)))
           (forall ((x)) (p3 x e x))
           (forall ((x)) (p3 e x x))
           (forall ((x)) (p3 x (i x) e))
           (forall ((x)) (p3 (i x) x e)))
    (forall ((u) (v) (w) (x))
      (implies (and (p3 (i u) (i v) w)
                    (p3 v u x))
        (p3 (i w) (i x) e)))))

;; not positive this is a theorem
(implies (and (forall ((e))
                (implies (greater-than-0 e)
                  (for-some ((d))
                    (and (greater-than-0 d)
                         (forall ((x))
                           (implies (and (greater-than-or-equal-to-0 x)
                                         (less-than x d))
                             (and (greater-than-or-equal-to-0 (f x))
                                  (less-than (f x) e))))))))
              (for-some ((x)) (greater-than-0 x))
              (forall ((a))
                (implies (greater-than-0 a) (greater-than-or-equal-to-0 a))))
  (forall ((x)) (implies (greater-than-or-equal-to-0 x)
                  (greater-than-or-equal-to-0 (f x)))))

;; not positive this is a theorem
(implies (and (for-some ((o))
                (forall ((x))
                  (implies (l x o) (l x (r x)))))
              (forall ((x) (y))
                (implies (l x y) (l (r y) (r x))))
              (forall ((x)) (for-some ((y)) (l x y)))
              (forall ((x)) (for-some ((y)) (l y x))))
  (forall ((b)) (for-some ((d)) (forall ((x))
                                  (implies (l x d)
                                    (l b (r x)))))))

;; not positive this is a theorem
(implies (and (forall ((x)) (implies (and (less-than-1 x)
                                          (and (not (isZero x)) (less-than-1 x)))
                              (less-than x (f x))))
              (forall ((x)) (implies (not (less-than-1 x))
                              (less-than (f x) x)))
              (forall ((x)) (implies (less-than-0 x) (less-than-1 x))))
  (forall ((e))
    (implies (greater-than-0 e)
      (for-some ((d))
        (and (greater-than-0 d)
             (forall ((x))
               (implies (and (greater-than-or-equal-to-0 x)
                             (less-than x d))
                 (and (greater-than-or-equal-to-0 (f x))
                      (less-than (f x) e)))))))))

;; not positive this is a theorem
(implies (and (for-some ((x)) (lt (zero) x))
              (for-some ((x)) (lt x (one)))
              (for-some ((x)) (lt (one) x))
              (lt (zero) (one))
              (forall ((x)) (implies (lt x (one))
                              (lt x (the-reciprocal-of x))))
              (forall ((x)) (implies (lt (one) x)
                              (lt (the-reciprocal-of x) x))))
  (forall ((b))
    (implies (lt (zero) b)
      (for-some ((d))
        (and (lt (zero) d)
             (forall ((x))
               (implies (and (lt (zero) x) (lt x d))
                 (lt b (the-reciprocal-of x)))))))))
